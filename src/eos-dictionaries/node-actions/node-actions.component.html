<div class="eos-node-actions">
    <ng-container *ngFor="let item of buttons">
        <ng-container *ngTemplateOutlet="btnTpl; context: item"></ng-container>
    </ng-container>

    <span class="visible-lg-inline-block actions" dropdown container="body">
        <button *ngIf="haveVisibleMore" class="btn btn-primary-light actions" [tooltip]="'Показать меню'" #itemTooltip="bs-tooltip"
            placement="right" containerClass="tooltip-info" dropdownToggle (click)="itemTooltip.hide()">
            <span class="eos-icon eos-icon-fab-blue small rotate"></span>
        </button>
        <ul *dropdownMenu class="dropdown-menu" role="menu">
            <li *ngFor="let item of moreButtons" role="menuitem" tooltip="{{item.hint}}" placement="right" containerClass="tooltip-info">
                <button *ngIf="item.show" [disabled]="!item.enabled" [ngClass]="{active: item.isActive}"
                    class="action-dropdown-item btn btn-primary-light" (click)="doAction(item.type)">
                    <span class="{{item.iconClass}}"></span>
                    <span class="drop-title">{{item.title}}</span>
                </button>
            </li>
        </ul>
    </span>

    <span class="btn-group hidden-lg" dropdown>
        <button class="btn btn-primary-light actions" dropdownToggle tooltip="Ещё" placement="bottom" containerClass="tooltip-info"
            #itemTooltip="bs-tooltip" (click)="itemTooltip.hide();">
            <span class="eos-icon eos-icon-fab-blue small"></span>
        </button>
        <ul *dropdownMenu class="dropdown-menu" role="menu">
            <ng-template ngFor let-item let-i="index" [ngForOf]="ddButtons">
                <li role="menuitem" tooltip="{{item.hint}}"
                    placement="bottom" containerClass="tooltip-info">
                    <button [disabled]="!item.enabled" [ngClass]="{active: item.isActive}"
                        class="btn dropdown-item btn-primary-light" (click)="doAction(item.type)">
                        <span class="{{item.iconClass}}"></span>
                        <span class="drop-title">{{item.title}}</span>
                    </button>
                </li>
            </ng-template>
        </ul>
    </span>
</div>

<ng-template #btnTpl
    let-show="show"
    let-hint="hint"
    let-enabled="enabled"
    let-isActive="isActive"
    let-buttonClass="buttonClass"
    let-icon="iconClass"
    let-activeIcon="activeIconClass"
    let-action="type">
    <span class="visible-lg-inline-block actions"
        *ngIf="show">
        <div [tooltip]="hint" #itemTooltip="bs-tooltip" placement="bottom" containerClass="tooltip-info">
        <ng-container *ngIf="action === ADD_ACTION && isTree">
            <span class="btn-group" dropdown>
            <button [disabled]="!enabled" class="btn btn-primary-light {{buttonClass}}" dropdownToggle [ngClass]="{active: isActive}" (click)="itemTooltip.hide();">
                <span [hidden]="isActive" [ngClass]="icon"></span>
                <span [hidden]="!isActive" [ngClass]="activeIcon"></span>
            </button>
            <ul *dropdownMenu class="dropdown-menu" role="menu">
                <li *ngFor="let item of addMenu" role="menuitem">
                    <button class="action-dropdown-item btn btn-primary-light"
                        (click)="doAction(action,item.params)">{{item.title}}</button>
                </li>
            </ul>
            </span>
        </ng-container>
        <ng-container *ngIf="action !== ADD_ACTION || !isTree">
            <button [disabled]="!enabled" class="btn btn-primary-light {{buttonClass}}" [ngClass]="{active: isActive}" (click)="itemTooltip.hide(); doAction(action)">
                <span [hidden]="isActive" [ngClass]="icon"></span>
                <span [hidden]="!isActive" [ngClass]="activeIcon"></span>
            </button>
        </ng-container>
        </div>
    </span>
</ng-template>
